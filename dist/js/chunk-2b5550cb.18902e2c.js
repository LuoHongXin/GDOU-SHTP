(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2b5550cb"],{"0607":function(e,r,t){"use strict";t.r(r);var a=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"zhuce"},[t("el-page-header",{attrs:{content:"修改个人信息"},on:{back:e.goBack}}),t("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[t("el-main",{staticStyle:{overflow:"auto"}},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"用户名",prop:"Username"}},[t("el-input",{model:{value:e.ruleForm.Username,callback:function(r){e.$set(e.ruleForm,"Username",r)},expression:"ruleForm.Username"}})],1),t("el-form-item",{attrs:{label:"手机号码",prop:"phone"}},[t("el-input",{model:{value:e.ruleForm.phone,callback:function(r){e.$set(e.ruleForm,"phone",r)},expression:"ruleForm.phone"}})],1),t("el-form-item",{attrs:{label:"微信号码",prop:"wechat"}},[t("el-input",{model:{value:e.ruleForm.wechat,callback:function(r){e.$set(e.ruleForm,"wechat",r)},expression:"ruleForm.wechat"}})],1),t("el-form-item",{attrs:{label:"宿舍",prop:"dorm"}},[t("el-input",{model:{value:e.ruleForm.dorm,callback:function(r){e.$set(e.ruleForm,"dorm",r)},expression:"ruleForm.dorm"}})],1),t("el-form-item",{attrs:{label:"班级",prop:"grade"}},[t("el-input",{model:{value:e.ruleForm.grade,callback:function(r){e.$set(e.ruleForm,"grade",r)},expression:"ruleForm.grade"}})],1),t("el-form-item",{attrs:{label:"密码",prop:"pass"}},[t("el-input",{attrs:{autocomplete:"off"},model:{value:e.ruleForm.pass,callback:function(r){e.$set(e.ruleForm,"pass",r)},expression:"ruleForm.pass"}})],1),t("el-form-item",[t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.submitForm("ruleForm")}}},[e._v("确认修改")]),t("el-button",{on:{click:function(r){return e.resetForm("ruleForm")}}},[e._v("重置")])],1)],1),t("div",{staticClass:"copyright"},[t("div",{staticClass:"ts"},[e._v("温馨提示")]),e._v(" 用户信息修改,只要填写对应表单信息点击确认修改即可成功修改对应信息 ")])],1)],1)],1)},o=[];const{modifyUser:s,userSearch:l}=t("365c"),{lookCookie:i,setCookie:n}=t("ed08");var u={data(){var e=(e,r,t)=>{r?setTimeout(async()=>{if(r.length<3||r.length>8)t(new Error("用户名应为3到8位字符"));else{let{data:e}=await l({keywords:r});e.length>0&&e[0]._id!=i("userId")?t(new Error("用户名已存在，请重新命名")):t()}},1e3):t()},r=(e,r,t)=>{r&&r.trim()<6?t(new Error("密码必须为6位以上")):t()},t=(e,r,t)=>{r?/^[\u4e00-\u9fa5]{2}\S{0,2}\d{3,6}$/.test(r.trim())?t():t(new Error("请输入宿舍号,例:海安A309,海滨1栋104")):t()},a=async(e,r,t)=>{if(r)if(/^1[3456789]\d{9}$/.test(r.trim())){let{data:e}=await l({keywords:r});e.length>0&&e[0]._id!=i("userId")?t(new Error("该手机号已被注册,若有问题请联系管理员")):t()}else t(new Error("请输入正确的手机号"));else t()},o=(e,r,t)=>{r?/^[\u4e00-\u9fa5]{2,}\d{4}$/.test(r.trim())?t():t(new Error("专业+班别,例:'信计1161'")):t()},s=async(e,r,t)=>{if(r){let{data:e}=await l({keywords:r});e.length>0&&e[0]._id!=i("userId")?t(new Error("该微信号已被注册,若不是本人操作,请联系管理员")):t()}else t()};return{loading:!1,ruleForm:{pass:"",Username:"",dorm:"",phone:"",grade:"",wechat:""},rules:{pass:[{validator:r,trigger:"blur"}],Username:[{validator:e,trigger:"blur"}],dorm:[{validator:t,trigger:"blur"}],phone:[{validator:a,trigger:"blur"}],grade:[{validator:o,trigger:"blur"}],wechat:[{validator:s,trigger:"blur"}]}}},async created(){this.loading=!0;let e=i("userName"),{data:r}=await l({keywords:e});this.ruleForm.Username=r[0].USER_NAME,this.ruleForm.pass=r[0].USER_PSW,this.ruleForm.dorm=r[0].USER_DORM,this.ruleForm.phone=r[0].USER_PHONE,this.ruleForm.grade=r[0].USER_CLASS,this.ruleForm.wechat=r[0].USER_WECHAT,this.loading=!1},methods:{async submitForm(e){this.loading=!0,this.$refs[e].validate(async e=>{if(e){let{pass:e,Username:r,dorm:t,phone:a,grade:o,wechat:l}=this.$data.ruleForm,u=i("userId");if(u){let{data:i}=await s({id:u,username:r,userpsw:e,userdorm:t,userphone:a,userwechat:l,userclass:o});i.modifiedCount>0&&(n("userName",r,1),this.$notify({title:"修改成功",message:"恭喜你，您的信息修改成功",type:"success"}))}else this.$notify({title:"请先登录用户",message:"用户未登录",type:"warning"})}}),this.loading=!1},resetForm(e){this.$refs[e].resetFields()},goBack(){this.$router.push("/user")}}},m=u,d=(t("ce24"),t("623f")),c=Object(d["a"])(m,a,o,!1,null,"4d2d03b9",null);r["default"]=c.exports},ce24:function(e,r,t){"use strict";var a=t("f768"),o=t.n(a);o.a},f768:function(e,r,t){}}]);
//# sourceMappingURL=chunk-2b5550cb.18902e2c.js.map