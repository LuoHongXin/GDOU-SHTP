{"version":3,"sources":["webpack:///./src/components/modifyPersonalInf.vue?4af1","webpack:///src/components/modifyPersonalInf.vue","webpack:///./src/components/modifyPersonalInf.vue?a5f8","webpack:///./src/components/modifyPersonalInf.vue","webpack:///./src/components/modifyPersonalInf.vue?324d"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","attrs","on","goBack","directives","name","rawName","value","expression","staticStyle","ref","ruleForm","rules","model","callback","$$v","$set","$event","submitForm","_v","resetForm","staticRenderFns","component"],"mappings":"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","file":"js/chunk-217c6ee8.8a972bf8.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"zhuce\"},[_c('el-page-header',{attrs:{\"content\":\"修改个人信息\"},on:{\"back\":_vm.goBack}}),_c('el-container',{directives:[{name:\"loading\",rawName:\"v-loading\",value:(_vm.loading),expression:\"loading\"}]},[_c('el-main',{staticStyle:{\"overflow\":\"auto\"}},[_c('el-form',{ref:\"ruleForm\",staticClass:\"demo-ruleForm\",attrs:{\"model\":_vm.ruleForm,\"status-icon\":\"\",\"rules\":_vm.rules,\"label-width\":\"100px\"}},[_c('el-form-item',{attrs:{\"label\":\"用户名\",\"prop\":\"Username\"}},[_c('el-input',{model:{value:(_vm.ruleForm.Username),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"Username\", $$v)},expression:\"ruleForm.Username\"}})],1),_c('el-form-item',{attrs:{\"label\":\"手机号码\",\"prop\":\"phone\"}},[_c('el-input',{model:{value:(_vm.ruleForm.phone),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"phone\", $$v)},expression:\"ruleForm.phone\"}})],1),_c('el-form-item',{attrs:{\"label\":\"微信号码\",\"prop\":\"wechat\"}},[_c('el-input',{model:{value:(_vm.ruleForm.wechat),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"wechat\", $$v)},expression:\"ruleForm.wechat\"}})],1),_c('el-form-item',{attrs:{\"label\":\"宿舍\",\"prop\":\"dorm\"}},[_c('el-input',{model:{value:(_vm.ruleForm.dorm),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"dorm\", $$v)},expression:\"ruleForm.dorm\"}})],1),_c('el-form-item',{attrs:{\"label\":\"班级\",\"prop\":\"grade\"}},[_c('el-input',{model:{value:(_vm.ruleForm.grade),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"grade\", $$v)},expression:\"ruleForm.grade\"}})],1),_c('el-form-item',{attrs:{\"label\":\"密码\",\"prop\":\"pass\"}},[_c('el-input',{attrs:{\"autocomplete\":\"off\"},model:{value:(_vm.ruleForm.pass),callback:function ($$v) {_vm.$set(_vm.ruleForm, \"pass\", $$v)},expression:\"ruleForm.pass\"}})],1),_c('el-form-item',[_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":function($event){return _vm.submitForm('ruleForm')}}},[_vm._v(\"确认修改\")]),_c('el-button',{on:{\"click\":function($event){return _vm.resetForm('ruleForm')}}},[_vm._v(\"重置\")])],1)],1),_c('div',{staticClass:\"copyright\"},[_c('div',{staticClass:\"ts\"},[_vm._v(\"温馨提示\")]),_vm._v(\" 用户信息修改,只要填写对应表单信息点击确认修改即可成功修改对应信息 \")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n<div class=\"zhuce\">\r\n<el-page-header @back=\"goBack\" content=\"修改个人信息\">\r\n   </el-page-header>\r\n<el-container v-loading='loading'>\r\n    <el-main style=\"overflow:auto;\">   \r\n        <el-form :model=\"ruleForm\"  status-icon :rules=\"rules\" ref=\"ruleForm\" label-width=\"100px\" class=\"demo-ruleForm\">\r\n            <el-form-item label=\"用户名\" prop=\"Username\">\r\n                <el-input v-model=\"ruleForm.Username\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"手机号码\" prop=\"phone\">\r\n                <el-input v-model=\"ruleForm.phone\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"微信号码\" prop=\"wechat\">\r\n                <el-input v-model=\"ruleForm.wechat\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"宿舍\" prop=\"dorm\">\r\n                <el-input v-model=\"ruleForm.dorm\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"班级\" prop=\"grade\">\r\n                <el-input v-model=\"ruleForm.grade\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item label=\"密码\" prop=\"pass\">\r\n                <el-input v-model=\"ruleForm.pass\" autocomplete=\"off\"></el-input>\r\n            </el-form-item>\r\n            <el-form-item>\r\n                <el-button type=\"primary\" @click=\"submitForm('ruleForm')\">确认修改</el-button>\r\n                <el-button @click=\"resetForm('ruleForm')\">重置</el-button>\r\n            </el-form-item>\r\n        </el-form>\r\n        <div class=\"copyright\">\r\n            <div class=\"ts\">温馨提示</div>\r\n          用户信息修改,只要填写对应表单信息点击确认修改即可成功修改对应信息\r\n        </div>\r\n    </el-main>\r\n</el-container>\r\n </div>\r\n</template>\r\n<script>\r\nconst {modifyUser,checkname,checkuserphone,checkuserwechat,userSearch} = require('../api');\r\nconst {lookCookie,setCookie} = require('../utils');\r\nexport default {\r\n     data() {\r\n          var checkUsername = (rule, value, callback) => {\r\n              if(value){\r\n                  setTimeout(async () => {\r\n                    if (value.length<3||value.length>8) {\r\n                      callback(new Error('用户名应为3到8位字符'));\r\n                    } else {\r\n                        let data =await checkname(value);\r\n                        if(data.data===0){\r\n                            callback(); \r\n                        }else{\r\n                            callback(new Error('用户名已存在，请重新命名')); \r\n                        }\r\n                      }\r\n                  }, 1000);\r\n              }else{\r\n          callback();\r\n      }\r\n      };\r\n       var validatePass = (rule, value, callback) => {\r\n        if (value && value.trim()<6) {\r\n          callback(new Error('密码必须为6位以上'));\r\n        }else{\r\n          callback();\r\n      }\r\n      };\r\n       var checkdorm = (rule,value,callback)=>{//宿舍验证\r\n       if(value){\r\n           if(!(/^[\\u4e00-\\u9fa5]{2}\\S{0,2}\\d{3,6}$/.test(value.trim()))){\r\n               callback(new Error('请输入宿舍号,例:海安A309,海滨1栋104'));\r\n           }else{\r\n               callback();\r\n           }\r\n       }else{\r\n          callback();\r\n      }\r\n      };\r\n      var checkphone = async (rule,value,callback)=>{//手机号验证\r\n      if(value){\r\n          if(!(/^1[3456789]\\d{9}$/.test(value.trim()))){\r\n              callback(new Error('请输入正确的手机号'));\r\n          }else{\r\n              let {data} = await checkuserphone(value);\r\n              if(data==1){\r\n                  callback(new Error('该手机号已被注册,若有问题请联系管理员'));\r\n              }else{\r\n                callback();\r\n              }\r\n          }\r\n      }else{\r\n          callback();\r\n      }\r\n      };\r\n       var checkgrade = (rule,value,callback)=>{//班级验证\r\n       if(value){\r\n           if(!(/^[\\u4e00-\\u9fa5]{2,}\\d{4}$/.test(value.trim()))){\r\n               callback(new Error(\"专业+班别,例:'信计1161'\"));\r\n           }else{\r\n               callback();\r\n           }\r\n       }else{\r\n          callback();\r\n      }\r\n      };\r\n       var checkwechat = async (rule,value,callback)=>{//微信号\r\n        if(value){\r\n                let {data} = await checkuserwechat(value);\r\n                if(data==1){\r\n                    callback(new Error('该微信号已被注册,若不是本人操作,请联系管理员'));\r\n                }else{\r\n                    callback();\r\n                }\r\n        }else{\r\n          callback();\r\n      }\r\n      }\r\n      return {\r\n        loading:false,\r\n        ruleForm: {\r\n          pass: '',\r\n          Username: '',//用户名\r\n          dorm:'',//宿舍\r\n          phone:'',//手机\r\n          grade:'',//班级\r\n          wechat:''//微信号\r\n        },\r\n           rules: {\r\n          pass: [\r\n            { validator: validatePass, trigger: 'blur' }\r\n          ],\r\n          Username: [\r\n            { validator: checkUsername, trigger: 'blur' }\r\n          ],\r\n          dorm:[{\r\n              validator: checkdorm, trigger: 'blur' \r\n          }],\r\n          phone:[{ validator: checkphone, trigger: 'blur' }],\r\n          grade:[{ validator: checkgrade, trigger: 'blur' }],\r\n          wechat:[{validator: checkwechat, trigger: 'blur'}]\r\n        }\r\n      };\r\n    },\r\n    async created(){\r\n        this.loading = true;\r\n        let username = lookCookie('userName');\r\n        let {data} = await userSearch({keywords:username});\r\n        this.ruleForm.Username = data[0].USER_NAME;\r\n        this.ruleForm.pass = data[0].USER_PSW;\r\n        this.ruleForm.dorm = data[0].USER_DORM;\r\n        this.ruleForm.phone = data[0].USER_PHONE;\r\n        this.ruleForm.grade = data[0].USER_CLASS;\r\n        this.ruleForm.wechat = data[0].USER_WECHAT;\r\n        this.loading = false;\r\n    },\r\n    methods: {\r\n      async submitForm(formName) {\r\n          this.loading = true;\r\n           this.$refs[formName].validate(async (valid) => {\r\n               if(valid){\r\n                   let {pass,Username,dorm,phone,grade,wechat} = this.$data.ruleForm;\r\n                //    window.console.log({pass,Username,dorm,phone,grade,wechat})\r\n                   let id = lookCookie('userId');\r\n                   if(id){\r\n                       let {data} = await modifyUser({\r\n                         id:id,\r\n                         username:Username,\r\n                         userpsw:pass,\r\n                         userdorm:dorm,\r\n                         userphone:phone,\r\n                         userwechat:wechat,\r\n                         userclass:grade,\r\n                       });\r\n                       if(data.modifiedCount>0){\r\n                           setCookie('userName',Username,1)\r\n                           this.$notify({\r\n                             title: '修改成功',\r\n                             message: `恭喜你，您的信息修改成功`,\r\n                             type: 'success'\r\n                         });\r\n                       }\r\n                   }else{\r\n                       this.$notify({\r\n                           title: '请先登录用户',\r\n                           message: `用户未登录`,\r\n                           type: 'warning'\r\n                         });\r\n                   }\r\n               }\r\n           });\r\n           this.loading = false;\r\n      },\r\n      resetForm(formName) {\r\n        this.$refs[formName].resetFields();\r\n      },\r\n      goBack(){\r\n        this.$router.push('/user')\r\n      }\r\n    }\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.el-main{\r\n   height:calc(100vh - 113px);\r\n}\r\n.zhuce::v-deep .el-page-header{\r\n    padding: 3vw;\r\n    height: 44px;\r\n    line-height: 44px;\r\n    background: #fff;\r\n    font-size: 17px;\r\n}\r\n::v-deep .el-form-item__label{\r\n  width: 70px !important;\r\n}\r\n::v-deep .el-form-item__content{\r\n  margin-left: 70px !important;\r\n  padding-right: 5vw;\r\n}\r\n::v-deep .el-input__inner{\r\n  height: 30px;\r\n}\r\n.copyright{\r\n    text-align: center;\r\n    font-size: 14px;\r\n    .ts{\r\n        font-weight: 600;\r\n        font-size: 16px;\r\n    }\r\n}\r\n</style>","import mod from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.0@vue-loader/lib/index.js??vue-loader-options!./modifyPersonalInf.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--12-0!../../node_modules/_thread-loader@2.1.3@thread-loader/dist/cjs.js!../../node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.0@vue-loader/lib/index.js??vue-loader-options!./modifyPersonalInf.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./modifyPersonalInf.vue?vue&type=template&id=fbc966aa&scoped=true&\"\nimport script from \"./modifyPersonalInf.vue?vue&type=script&lang=js&\"\nexport * from \"./modifyPersonalInf.vue?vue&type=script&lang=js&\"\nimport style0 from \"./modifyPersonalInf.vue?vue&type=style&index=0&id=fbc966aa&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/_vue-loader@15.9.0@vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"fbc966aa\",\n  null\n  \n)\n\nexport default component.exports","import mod from \"-!../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/_css-loader@3.4.2@css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/_vue-loader@15.9.0@vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/_sass-loader@8.0.2@sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.0@vue-loader/lib/index.js??vue-loader-options!./modifyPersonalInf.vue?vue&type=style&index=0&id=fbc966aa&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../node_modules/_mini-css-extract-plugin@0.9.0@mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/_css-loader@3.4.2@css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/_vue-loader@15.9.0@vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/_postcss-loader@3.0.0@postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/_sass-loader@8.0.2@sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/_cache-loader@4.1.0@cache-loader/dist/cjs.js??ref--0-0!../../node_modules/_vue-loader@15.9.0@vue-loader/lib/index.js??vue-loader-options!./modifyPersonalInf.vue?vue&type=style&index=0&id=fbc966aa&lang=scss&scoped=true&\""],"sourceRoot":""}