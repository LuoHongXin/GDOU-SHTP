(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-12524e17"],{"281d":function(e,r,t){"use strict";var l=t("bc06"),o=t.n(l);o.a},bbff:function(e,r,t){"use strict";t.r(r);var l=function(){var e=this,r=e.$createElement,t=e._self._c||r;return t("div",{staticClass:"zhuce"},[t("el-page-header",{attrs:{content:e.title},on:{back:e.goBack}}),t("el-container",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}]},[t("el-main",{staticStyle:{overflow:"auto"}},[t("el-form",{ref:"ruleForm",staticClass:"demo-ruleForm",attrs:{model:e.ruleForm,"status-icon":"",rules:e.rules,"label-width":"100px"}},[t("el-form-item",{attrs:{label:"商品名称",prop:"PRODUCT_NAME"}},[t("el-input",{model:{value:e.ruleForm.PRODUCT_NAME,callback:function(r){e.$set(e.ruleForm,"PRODUCT_NAME",r)},expression:"ruleForm.PRODUCT_NAME"}})],1),t("el-form-item",{attrs:{label:"商品价格",prop:"PRODUCT_PRICE"}},[t("el-input",{attrs:{type:"number"},model:{value:e.ruleForm.PRODUCT_PRICE,callback:function(r){e.$set(e.ruleForm,"PRODUCT_PRICE",r)},expression:"ruleForm.PRODUCT_PRICE"}})],1),t("el-form-item",{attrs:{label:"截至时间",prop:"DEADLINE"}},[t("el-date-picker",{attrs:{type:"datetime",placeholder:"选择日期时间"},model:{value:e.ruleForm.DEADLINE,callback:function(r){e.$set(e.ruleForm,"DEADLINE",r)},expression:"ruleForm.DEADLINE"}})],1),t("el-form-item",{attrs:{label:"商品数量",prop:"PRODUCT_NUM"}},[t("el-input",{attrs:{type:"number"},model:{value:e.ruleForm.PRODUCT_NUM,callback:function(r){e.$set(e.ruleForm,"PRODUCT_NUM",r)},expression:"ruleForm.PRODUCT_NUM"}})],1),t("el-form-item",{attrs:{label:"商品类别",prop:"PRODUCT_CLASS"}},[t("el-select",{attrs:{placeholder:"请选择"},model:{value:e.ruleForm.PRODUCT_CLASS,callback:function(r){e.$set(e.ruleForm,"PRODUCT_CLASS",r)},expression:"ruleForm.PRODUCT_CLASS"}},e._l(e.productType,(function(e){return t("el-option",{key:e.TYPE,attrs:{label:e.NAME,value:e.TYPE}})})),1)],1),t("el-form-item",{attrs:{label:"卖家称呼",prop:"SELLER_NAME"}},[t("el-input",{model:{value:e.ruleForm.SELLER_NAME,callback:function(r){e.$set(e.ruleForm,"SELLER_NAME",r)},expression:"ruleForm.SELLER_NAME"}})],1),t("el-form-item",{attrs:{label:"宿舍",prop:"SELLER_DORM"}},[t("el-input",{model:{value:e.ruleForm.SELLER_DORM,callback:function(r){e.$set(e.ruleForm,"SELLER_DORM",r)},expression:"ruleForm.SELLER_DORM"}})],1),t("el-form-item",{attrs:{label:"联系方式",prop:"SELLER_PHONE"}},[t("el-input",{model:{value:e.ruleForm.SELLER_PHONE,callback:function(r){e.$set(e.ruleForm,"SELLER_PHONE",r)},expression:"ruleForm.SELLER_PHONE"}})],1),t("el-form-item",{attrs:{label:"微信号",prop:"SELLER_WECHAT"}},[t("el-input",{model:{value:e.ruleForm.SELLER_WECHAT,callback:function(r){e.$set(e.ruleForm,"SELLER_WECHAT",r)},expression:"ruleForm.SELLER_WECHAT"}})],1),t("el-form-item",{attrs:{label:"班级",prop:"SELLER_CLASS"}},[t("el-input",{model:{value:e.ruleForm.SELLER_CLASS,callback:function(r){e.$set(e.ruleForm,"SELLER_CLASS",r)},expression:"ruleForm.SELLER_CLASS"}})],1),t("el-form-item",{attrs:{label:"商品描述",prop:"DESCRIBE"}},[t("el-input",{attrs:{type:"textarea"},model:{value:e.ruleForm.DESCRIBE,callback:function(r){e.$set(e.ruleForm,"DESCRIBE",r)},expression:"ruleForm.DESCRIBE"}})],1),e.isfb?t("el-form-item",{attrs:{label:"上传图片",prop:"PRODUCT_PIC"}},[t("el-upload",{staticClass:"upload-demo",attrs:{action:e.uploadUrl,"on-remove":e.handleRemove,"on-success":e.handlePreview,"file-list":e.fileList,"list-type":"picture"}},[t("el-button",{attrs:{size:"small",type:"primary"}},[e._v("上传图片")]),t("div",{staticClass:"el-upload__tip",attrs:{slot:"tip"},slot:"tip"},[e._v("只能上传jpg/png文件，且不超过500kb")])],1)],1):e._e(),t("el-form-item",[e.isfb?t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.submitForm("release")}}},[e._v("发布商品")]):t("el-button",{attrs:{type:"primary"},on:{click:function(r){return e.submitForm("update")}}},[e._v("确认修改")])],1)],1),e.isfb?e._e():t("div",{staticClass:"copyright"},[t("div",{staticClass:"ts"},[e._v("温馨提示")]),e._v(" 商品信息修改,只要填写对应表单信息点击确认修改即可成功修改对应信息 ")])],1)],1)],1)},o=[],s="";const{getProductInfo:a,getProductType:i,updateProduct:u,userSearch:E,releaseProduct:n}=t("365c"),{lookCookie:m,uploadUrl:c,dateFormat:d}=t("ed08");var p={data(){var e=(e,r,t)=>{r?setTimeout(async()=>{r.length<3||r.length>8?t(new Error("用户名应为3到8位字符")):t()},1e3):t(new Error("不能为空"))},r=(e,r,t)=>{r?/^[\u4e00-\u9fa5]{2}\S{0,2}\d{3,6}$/.test(r.trim())?t():t(new Error("请输入宿舍号,例:海安A309,海滨1栋104")):t(new Error("不能为空"))},t=(e,r,t)=>{r?/^1[3456789]\d{9}$/.test(r.trim())?t():t(new Error("请输入正确的手机号")):t(new Error("不能为空"))},l=(e,r,t)=>{r?/^[\u4e00-\u9fa5]{2,}\d{4}$/.test(r.trim())?t():t(new Error("专业+班别,例:'信计1161'")):t(new Error("不能为空"))},o=(e,r,t)=>{r?t():t(new Error("不能为空"))},a=(e,r,t)=>{r?t():t(new Error("不能为空"))},i=(e,r,t)=>{r>=1?t():t(new Error("不能小于1"))},u=(e,r,t)=>{r?t():t(new Error("不能为空"))},E=(e,r,t)=>{r?t():t(new Error("不能为空"))},n=(e,r,t)=>{r?t():t(new Error("不能为空"))};return{title:"",productId:"",userName:"",loading:!1,productType:[],uploadUrl:c,fileList:[],userId:"",userSno:"",isfb:!0,ruleForm:{PRODUCT_NAME:"",PRODUCT_PRICE:"",PRODUCT_NUM:"",PRODUCT_CLASS:"others",SELLER_NAME:"",SELLER_DORM:"",SELLER_PHONE:"",SELLER_WECHAT:"",SELLER_CLASS:"",DEADLINE:"",DESCRIBE:"",PRODUCT_PIC:[]},rules:{SELLER_NAME:[{validator:e,trigger:"blur"}],SELLER_DORM:[{validator:r,trigger:"blur"}],SELLER_PHONE:[{validator:t,trigger:"blur"}],SELLER_CLASS:[{validator:l,trigger:"blur"}],SELLER_WECHAT:[{validator:o,trigger:"blur"}],PRODUCT_NAME:[{validator:a,trigger:"blur"}],PRODUCT_PRICE:[{validator:n,trigger:"blur"}],PRODUCT_NUM:[{validator:i,trigger:"blur"}],DEADLINE:[{validator:u,trigger:"blur"}],DESCRIBE:[{validator:E,trigger:"blur"}]},backUrl:s}},beforeRouteEnter(e,r,t){s=r.fullPath,t()},async created(){this.loading=!0;let e=await i();if(this.productType=e.data,this.$route.query&&this.$route.query.id){this.isfb=!1,this.productId=this.$route.query.id,this.title="修改商品发布信息";let{data:e}=await a(this.productId);this.ruleForm=Object.assign(this.ruleForm,e[0])}else{this.isfb=!0,this.productId="",this.userName=m("userName"),this.userId=m("userId");let{data:e}=await E({keywords:this.userName});this.title="发布新商品",this.ruleForm.SELLER_NAME=e[0].USER_NAME,this.ruleForm.SELLER_DORM=e[0].USER_DORM,this.ruleForm.SELLER_CLASS=e[0].USER_CLASS,this.ruleForm.SELLER_PHONE=e[0].USER_PHONE,this.ruleForm.SELLER_WECHAT=e[0].USER_WECHAT,this.userSno=e[0].USER_SNO}this.loading=!1},methods:{handleRemove(e,r){window.console.log(e,r)},handlePreview(e,r,t){this.ruleForm.PRODUCT_PIC.push(e),window.console.log(e,r,t)},async submitForm(e){var r=this;this.$refs["ruleForm"].validate(async t=>{if(t){if(this.loading=!0,"update"==e){let e=this.ruleForm,r=await u({productid:this.productId,porductname:e.PRODUCT_NAME,productprice:e.PRODUCT_PRICE,productnum:e.PRODUCT_NUM,productclass:e.PRODUCT_CLASS,sellername:e.SELLER_NAME,sellerdorm:e.SELLER_DORM,sellerphone:e.SELLER_PHONE,sellerwechat:e.SELLER_WECHAT,sellerclass:e.SELLER_CLASS,deadline:e.DEADLINE,describe:e.DESCRIBE});1==r.code?this.$notify({title:"修改成功",message:"商品信息修改成功",type:"success"}):this.$notify({title:"修改不成功",message:"商品信息修改失败",type:"warn"})}else if("release"==e){if(this.ruleForm.PRODUCT_PIC.length<=0)return void this.$notify({title:"上传商品图片",message:"请上传商品图片,能更好的帮你将商品推荐给其他用户",type:"warn"});{let e={SELLER_ID:this.userId,RELEASE_DATE:d("YYYY-mm-dd HH:MM:SS",new Date),SELLER_SNO:this.userSno};this.ruleForm=Object.assign(this.ruleForm,e);let t=await n(this.ruleForm);1==t.code?(this.$notify({title:"发布成功",message:"恭喜你,你的商品已发布成功,可在我发布的商品中查看",type:"success"}),r.goBack()):this.$notify({title:"发布失败",message:"请查看发布信息是否填写完整",type:"warn"})}}this.loading=!1}})},resetForm(e){this.$refs[e].resetFields()},goBack(){this.$router.push(s)}}},L=p,R=(t("281d"),t("623f")),S=Object(R["a"])(L,l,o,!1,null,"aeeaf070",null);r["default"]=S.exports},bc06:function(e,r,t){}}]);
//# sourceMappingURL=chunk-12524e17.80313049.js.map